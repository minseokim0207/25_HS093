## **ğŸ’¡1. í”„ë¡œì íŠ¸ ê°œìš”**

**1-1. í”„ë¡œì íŠ¸ ì†Œê°œ**
- í”„ë¡œì íŠ¸ ëª… : **CareBuddy** (ì¼€ì–´ë²„ë””)
- í”„ë¡œì íŠ¸ ì •ì˜ : ê³ ë ¹ì ë° ëŒë´„ ëŒ€ìƒìì˜ ì•ˆì „ì„ ì§€í‚¤ê³  ëŒë´„ ë¶€ë‹´ì„ ì™„í™”í•˜ëŠ” **ë ˆì¼ ì£¼í–‰í˜• AI ëª¨ë°”ì¼ ë¡œë´‡**
  
   <img width="650" height="300" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/mainImage.jpg?raw=true" /></br>

**1-2. ê°œë°œ ë°°ê²½ ë° í•„ìš”ì„±**
 
  1) ì´ˆê³ ë ¹í™” ì‚¬íšŒ ëŒ€ì‘ê³¼ ëŒë´„ ì¸ë ¥ ë¶€ì¡± í•´ê²° í•„ìš”

 - í†µê³„ì²­ì˜ â€˜2024 ê³ ë ¹ì í†µê³„â€™ ì— ë”°ë¥´ë©´, 2025ë…„ 65ì„¸ ì´ìƒ ê³ ë ¹ ì¸êµ¬ ì „ì²´ ì¸êµ¬ì˜ 20% ì´ìƒ ì•½ 1,051ë§Œ ëª… ì˜ˆìƒ
   
   <img width="650" height="300" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/populationExpectation.png?raw=true" /></br>
   
  - í˜„ì¬ 1ëª…ì˜ ìš”ì–‘ë³´í˜¸ì‚¬ê°€ 5.3~8.8ëª…ì˜ ëŒ€ìƒìë¥¼ ë‹´ë‹¹í•˜ëŠ” ë“± ê³¼ì¤‘í•œ ì—…ë¬´ í˜„ì‹¤
  - ìš”ì–‘ë³´í˜¸ì‚¬ ìˆ˜ìš” ê¸‰ì¦ì—ë„ ë¶ˆêµ¬í•˜ê³ , 2028ë…„ê¹Œì§€ ì•½ 11ë§Œ ëª… ë¶€ì¡± ì˜ˆìƒ
    
    <img width="650" height="300" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/ShortageOfNursingStaff.png?raw=true" /></br>
  
  2) ìŠ¤ë§ˆíŠ¸ ì¼€ì–´ ì‹œìŠ¤í…œì„ í†µí•´ íš¨ìœ¨ì ì´ê³  ì§€ì† ê°€ëŠ¥í•œ ëŒë´„ í™˜ê²½ ë§ˆë ¨ í•„ìš”


**1-3. í”„ë¡œì íŠ¸ íŠ¹ì¥ì **
- ê¸°ì¡´ ëŒë´„ ì¥ë¹„ ëŒ€ë¹„ ì‹¤ì‹œê°„ì„±ê³¼ ì •ë°€ì„±ì´ í–¥ìƒëœ ìŠ¤ë§ˆíŠ¸ ì‹œìŠ¤í…œ
  
  <img width="650" height="250" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/chart1.png?raw=true" /></br> 
- ê¸°ì¡´ CCTV ê¸°ë°˜ ëª¨ë‹ˆí„°ë§ ëŒ€ë¹„ ê°œì„  íš¨ê³¼
  
  <img width="650" height="300" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/chart2.png?raw=true" /></br>
 
**1-4. ì£¼ìš” ê¸°ëŠ¥**
- **On Device AI**: Hailo-8 ê¸°ë°˜ ë¡œì»¬ AI ì¶”ë¡ ìœ¼ë¡œÂ ë„¤íŠ¸ì›Œí¬ ì—†ì´ ì €ì§€ì—°Â·ê³ ì† ì—°ì‚° ê°€ëŠ¥
- **ì‹¤ì‹œê°„ ì´ë™í˜• ê´€ì¸¡ ì‹œìŠ¤í…œ**: ë ˆì¼í˜• ë¡œë´‡ì´ ì²œì¥ êµ¬ì¡°ë¥¼ ë”°ë¼ ì´ë™í•˜ì—¬ ì‚¬ê°ì§€ëŒ€ ë¬¸ì œ í•´ì†Œ
- **NOIR ì¹´ë©”ë¼ ê¸°ë°˜ ì•¼ê°„ ì¸ì‹ ê¸°ëŠ¥**: ì£¼.ì•¼ê°„í™˜ê²½ì—ì„œ 24ì‹œê°„ ì‹¤ì‹œê°„ ê°ì§€ ê°€ëŠ¥
- **ëª¨ë°”ì¼ ì‹¤ì‹œê°„ ì•Œë¦¼ ì—°ë™**: ì´ìƒí–‰ë™ ë°œìƒ ì‹œ ë³´í˜¸ì ì•±ìœ¼ë¡œ ì¦‰ì‹œ ì•Œë¦¼ ì „ì†¡
- **ìŒì„± ì¸í„°í˜ì´ìŠ¤**: ì´ìƒí–‰ë™ ë°œìƒ ì‹œ ë¸”ë£¨íˆ¬ìŠ¤ ìŠ¤í”¼ì»¤ë¥¼ í†µí•´ ì‹¤ë‚´ ê²½ê³  ì•Œë¦¼ ì œê³µ


**1-5. ê¸°ëŒ€ íš¨ê³¼ ë° í™œìš© ë¶„ì•¼**
1) ê¸°ëŒ€ íš¨ê³¼ 
- **ì¦‰ê° ëŒ€ì‘**: ì´ìƒí–‰ë™(ë‚™ìƒ) ì‹¤ì‹œê°„ ê°ì§€ â†’ ìŒì„±/ì•± ì•Œë¦¼ìœ¼ë¡œ ë³´í˜¸ì ë° ì˜ë£Œì§„ì˜ ì‹ ì†í•œ ëŒ€ì‘ ê°€ëŠ¥
- **ì‚¬ê°ì§€ëŒ€ ìµœì†Œí™”**: ì´ë™í˜• ë ˆì¼ ë¡œë´‡ + NOIR ì¹´ë©”ë¼ë¡œ ì£¼ì•¼ê°„ ê°ì‹œ ë° ì‚¬ê°ì§€ëŒ€ í•´ì†Œ
- **í†µí–‰ ë°©í•´ í•´ì†Œ**: ì²œì¥ ì„¤ì¹˜ êµ¬ì¡°ë¡œ ë°”ë‹¥ ê³µê°„ ì ìœ  ì—†ì´ ì„¤ì¹˜ ê°€ëŠ¥.

2) í™œìš© ë¶„ì•¼ 
- **ì˜ë£ŒÂ·ëŒë´„**: ìš”ì–‘ë³‘ì›, ìš”ì–‘ì›, ì¥ì• ì¸ ì‹œì„¤ ë“±ì—ì„œ ë‚™ìƒÂ·ì‹¤ì‹  ë“± ì´ìƒí–‰ë™ ì‹¤ì‹œê°„ ê°ì§€ ë° ì•Œë¦¼
- **ë³´ìœ¡ì‹œì„¤**: ìœ ì•„ì˜ ìœ„í—˜ í–‰ë™Â·ì“°ëŸ¬ì§ ë“± ì‹œì•¼ ë°– ìƒí™© ìë™ ì¸ì‹
- **ì‚°ì—… í˜„ì¥**: ì‘ì—…ìì˜ ì´ìƒ ë™ì‘Â·ì¬í•´ ìƒí™© ì¡°ê¸° ê°ì§€ë¡œ ì•ˆì „ì‚¬ê³  ì˜ˆë°©
- **ìŠ¤ë§ˆíŠ¸ í™ˆ**: 1ì¸ ê°€êµ¬Â·ê³ ìœ„í—˜êµ°ì˜ ëŒë°œ í–‰ë™ ê°ì§€ ë° ë¹„ìƒ ëŒ€ì‘ ì§€ì›


**1-6. ê¸°ìˆ  ìŠ¤íƒ**
- í”„ë¡ íŠ¸ì—”ë“œ : MIT App Inventor
- Edge Device : Raspberry Pi 5, Hailo-8 AI HAT+, Arduino Nano RP2040, TCP/IP
- AI/ML : YOLOv8, PyTorch, Hailo SDK
- ë°°í¬ ë° ê´€ë¦¬ : Docker, GitHub Actions

---

## **ğŸ’¡2. íŒ€ì› ì†Œê°œ**
| <img width="80" height="100" src="https://github.com/minseokim0207/assets/blob/master/img/mentee1.jpg?raw=true" > | <img width="80" height="100" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/mentee2.jpg?raw=true" > | <img width="80" height="100" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/mentee3.jpg?raw=true" > | <img width="80" height="100" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/mentee4.jpg?raw=true" > | 
|:---:|:---:|:---:|:---:|
| **ê¹€ë¯¼ì„œ** | **ë°•ê±´í¬** | **ë¼ì˜ì›…** | **ê¹€íš¨ì£¼** |
| â€¢ ê°œë°œì´ê´„ <br> â€¢ ë°ì´í„° ë¶„ì„ | â€¢ UI/UX ê¸°íš <br> â€¢ ë¬¸ì„œ ì‘ì„± | â€¢ í•˜ë“œì›¨ì–´ ì œì‘ <br> â€¢ í”„ë¡ íŠ¸ì—”ë“œ |â€¢ í•˜ë“œì›¨ì–´ ì„¤ê³„ <br> â€¢ ì„ë² ë””ë“œ ì œì–´| 



---
## **ğŸ’¡3. ì‹œìŠ¤í…œ êµ¬ì„±ë„**
- ì„œë¹„ìŠ¤ íë¦„ë„
  
<img width="600" height="300" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/ServiceFlowChart1.png?raw=true" />

- S/W êµ¬ì„±ë„
  
<img width="600" height="550" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/softwareConfigurationDiagram1.png?raw=true" />  

- H/W êµ¬ì„±ë„
  
<img width="1200" height="700" alt="image" src="https://github.com/minseokim0207/assets/blob/master/img/HardwareConfigurationDiagram.png?raw=true" />  


<!-- ì—”í‹°í‹° ê´€ê³„ë„
  
<img width="500" height="500" alt="image" src="https://github.com/user-attachments/assets/76e3347b-6d94-491e-8aeb-a7b4601c54d5" /> -->


---
## **ğŸ’¡4. ì‘í’ˆ ì†Œê°œì˜ìƒ**

[![í•œì´ìŒ ë“œë¦¼ì—… í”„ë¡œì íŠ¸ ì†Œê°œ](https://github.com/minseokim0207/assets/blob/master/img/youtubeImage.png?raw=true)](https://youtu.be/md-1Mj3nchI?si=9WYguuIe8CvcwUC6)


---
## **ğŸ’¡5. í•µì‹¬ ì†ŒìŠ¤ì½”ë“œ**
```python
  
import os, socket, time, threading, subprocess
from collections import deque
from pathlib import Path
import gi
gi.require_version('Gst', '1.0')
from gi.repository import Gst
import hailo

from hailo_apps.hailo_app_python.core.gstreamer.gstreamer_app import app_callback_class
from hailo_apps.hailo_app_python.apps.detection_simple.detection_pipeline_simple import GStreamerDetectionApp

LABELS_AND_AUDIO = {"fall": "/home/user/CareBuddy.mp3"}
CONF_THRESH = 0.70
BED_CONF_THRESH = 0.30
AUDIO_PLAY_DELAY = 2.0
HOST = "0.0.0.0"
PORT = 12345
SMOOTHING_WINDOW = 5   

class TCPServer:
    def __init__(self, host, port):
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.sock.bind((host, port))
        self.sock.listen()
        print("[TCP] Server start, waiting for client...")
        self.conn, self.addr = self.sock.accept()
        print(f"[TCP] Client connected: {self.addr}")

    def send(self, message: str):
        try:
            self.conn.sendall(message.encode())
            print(f"[TCP] send: {message}")
        except Exception as e:
            print(f"[TCP] Error: {e}")

class SoundPlayer:
    def __init__(self, audio_path: Path):
        self.audio_path = Path(audio_path).resolve()
        if not self.audio_path.exists():
            raise FileNotFoundError(f"Audio file not found: {self.audio_path}")
        self._lock = threading.Lock()

    def _play_gstreamer(self):
        pipeline = Gst.parse_launch(f'playbin uri=file://{self.audio_path}')
        pipeline.set_state(Gst.State.PLAYING)
        bus = pipeline.get_bus()
        bus.timed_pop_filtered(10*Gst.SECOND, Gst.MessageType.EOS|Gst.MessageType.ERROR)
        pipeline.set_state(Gst.State.NULL)
        del pipeline

    def play(self):
        def worker():
            try: self._play_gstreamer()
            except: subprocess.run(["aplay","-q",str(self.audio_path)],check=False)
        with self._lock:
            threading.Thread(target=worker,daemon=True).start()

def is_center_inside(fall_box, bed_box):
    fx, fy, fw, fh = fall_box.xmin(), fall_box.ymin(), fall_box.width(), fall_box.height()
    bx, by, bw, bh = bed_box.xmin(), bed_box.ymin(), bed_box.width(), bed_box.height()
    cx, cy = fx + fw/2, fy + fh/2
    return (bx <= cx <= bx + bw) and (by <= cy <= by + bh)

class user_app_callback_class(app_callback_class):
    def __init__(self, players=None, tcp_server=None):
        super().__init__()
        self.players=players
        self.tcp_server=tcp_server
        self.last_global_play_ts=0.0
        self.fall_history = deque(maxlen=SMOOTHING_WINDOW)

def app_callback(pad, info, user_data: user_app_callback_class):
    buffer=info.get_buffer()
    if buffer is None: return Gst.PadProbeReturn.OK
    roi=hailo.get_roi_from_buffer(buffer)
    detections=roi.get_objects_typed(hailo.HAILO_DETECTION)
    now=time.time()

    fall_detected=False
    bed_boxes=[d.get_bbox() for d in detections if d.get_label()=="bed" and d.get_confidence()>=BED_CONF_THRESH]

    for det in detections:
        if det.get_label()!="fall" or det.get_confidence()<CONF_THRESH: 
            continue
        fall_box=det.get_bbox()

        if any(is_center_inside(fall_box,b) for b in bed_boxes):
            print("[INFO] Fall ignored (center suppression).")
            continue

        fall_detected=True

    user_data.fall_history.append(fall_detected)

    smoothed_fall = sum(user_data.fall_history) > (len(user_data.fall_history)//2)

    if smoothed_fall:
        if (now-user_data.last_global_play_ts)>=AUDIO_PLAY_DELAY:
            user_data.players["fall"].play()
            if user_data.tcp_server: user_data.tcp_server.send("Fall")
            user_data.last_global_play_ts=now
    return Gst.PadProbeReturn.OK

if __name__=="__main__":
    Gst.init(None)
    tcp_server=TCPServer(HOST,PORT)
    players={"fall":SoundPlayer(Path(LABELS_AND_AUDIO["fall"]))}
    user_data=user_app_callback_class(players,tcp_server)
    app=GStreamerDetectionApp(app_callback,user_data)
    app.run()

```
